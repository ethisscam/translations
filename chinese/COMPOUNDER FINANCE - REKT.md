---
title: COMPOUNDER FINANCE - REKT
date: 2020年12月2日
tags:
  - c3pr
  - 审计
  - 跑路
excerpt: rekt收割机有办法让人开口说话。在最后关头，当总锁仓量接近零，回撤变得难以忍受时，一个姓名不详的人物进入了聊天室。跟随我们记者的脚步调查Compounder Finance1200万美元跑路事件。
banner: https://lh6.googleusercontent.com/TLkLMvzALcncoyVu5MGEumqmlOqk7KWADtRJ8Uj62TXUWi_SZg_gw9iiF9hVi_vgMp55Jvpy5Bl0d_ZxOcmJfZnEALbmRDkcrfbNPaO3F4b-qsIEjOfU3Tp4bKk54JN2wzTCVDhE
---

![](https://lh6.googleusercontent.com/TLkLMvzALcncoyVu5MGEumqmlOqk7KWADtRJ8Uj62TXUWi_SZg_gw9iiF9hVi_vgMp55Jvpy5Bl0d_ZxOcmJfZnEALbmRDkcrfbNPaO3F4b-qsIEjOfU3Tp4bKk54JN2wzTCVDhE)

**rekt收割机有办法让人开口说话。**

在最后关头，当总锁仓量接近零，回撤变得难以忍受时，一个姓名不详的人物进入了聊天室。

当一个协议伤痕累累，无法修复，是时候摆脱尘世烦恼，第四个也是最后一个骑士到来，引导他们去往来世，以.gif格式呈现。

**[Compounder.finance](http://compounder.finance/)拿着超过12,000,000美元跑路去了。**

在我们这个动荡不安的社会中，贪婪和绝望以同样但不可预测的方式受到惩罚和回报。

在这个社会中，罪人得到救赎，他们的过失被人遗忘，因为他们披着隐姓埋名的外衣逃到了下游。

Rekt在这里照亮罪人--揭露他们的方法，好让大家都能从中学习。

**compounder.financial网站和推特账号瞬间被删除。**

**已完成的安全审计为我们的侦探提供了唯一线索。**

现在是[RektHQ](https://twitter.com/RektHQ)忙碌的时候，当我们开始调查时已过去几个小时...当我们联系审计人员要求报价时，他们却不太高兴看到我们。 

![](https://lh4.googleusercontent.com/j_yn7CTMvy6RhjtNHFw7jRwsT0Eossl9zY3lzlm5Uq-hxz2AE-V1Zf97vT11BfwAU-HH1YVRhIEfA6YqwHpDAaSA_dVNpY_VoSvGcUgGXyRdHVVqVOX03YWiJ1AWkK48OKTX6Nsf)

> **请不要发来像这样的狗屎，因为你的所作所为，我确实担忧自己的安全，我要一分钟的时间才能平静下来，胆小的人可能早就报案了。**

在我们的侦探提供了一些保证后，Solidity.financial向我们提供了他们与compounder.financial的完整[聊天记录](https://solidity.finance/audits/CP3R/ChatLogs.pdf)。

![](https://lh6.googleusercontent.com/jmSOsLERtND5cPjpj5zRKXEsyPg-vqXNGixs02ru1ZYLSMTjxSN4S8ZtDflMFHiI4ImG7ou-B6XA6P201hR94CjS09-Pk7rVkQ2WR4mu0u8SIpjnXx2FPXr99UBJMc8phplKmMlk)

其他受害者也向我们求助，显示了他们早期与compounder管理员进行的对话，他们在对话中表达了自己的担忧。 

![](https://lh5.googleusercontent.com/-wS-a_Bpwg90_-BScXqJTSVhYm1nsNF2WyFBwrTUUslw-wy4eYm_t2cb0LUCwny5jLWGmfJZNN6uDQxSkcbJVOakKBpJJMjXaWr9mLxrhxxFkm_SY_gWUfFq15bg3TUft-UlUBsl)

Solidity.financial告诉我们，他们只和管理员简单地说了几句话，虽然他们确实审核过合约，但他们在文件中表示，虽然资金池由时间锁控制，但时间锁不提供任何保护。

以下信息来自他们的聊天记录。 

![](https://raw.githubusercontent.com/RektHQ/Assets/main/images/2020/12/image.png)

在我们调查的现阶段，solidity.financial仍然有嫌疑。我们想知道为什么他们会认为compounder.financial团队看起来"非常值得信赖"  

![](https://lh3.googleusercontent.com/zAnDE5lhy4th23b04O90LfyMOzuZNKVQpGJSbvm1l9nyik3ALWHNN9w2ESpA9vVgbhUr4mG8RKoWHJs9vA-xxlg5tSHWy0cdYedy26u46htRO2F6DM6ueioCBHkqYyA336fkbeNY)

![](https://lh4.googleusercontent.com/3cTLMXUqzGK79tC0tquzA-fJHOgDMyfrNrJywsKGRyCvSNUPI6C097QgqvUeOBASoWAnvVnx4GGcYpkJgD2rHxcrc9uBkkoToqtqzn1DNBOlmBmk6gP-ueO1kwfyQtYjfYerCmsK)

在阅读聊天记录时，我们注意到虽然账户已被删除，但有一个用户名仍然存在--"keccak"。  

![](https://raw.githubusercontent.com/RektHQ/Assets/main/images/2020/12/image-1.png)

![](https://lh6.googleusercontent.com/2Rer5ONASpGduNUGsKPIG7WjVnvSk0qldLQC3qKVl1GaC8H9eTkAEuwRxApHZV1-eRNs4z18n2lRWjM9_aKDwDjunZPqkUIn2cUh1APe3MTSUnpjhd1YkInL0NMzc9L391CWpNtN)

虽然solidity.financial声称keccak已删除他们的账户，但我们已找到他们的账户，并试图取得联系。 

![](https://lh4.googleusercontent.com/n843mEGRcOHYLt5WsOuC5CpMrwAyICOJ9Mj92qHGWjSUko2CSgUhwsRMQhTKUNj0mQnFebVnlX3GXJ9J6aEErSbqYIf0nAAjR7SargO3_dm1xuUIRiLP3mHlF23pxpMjVqZ-Bk6B)

遗憾的是，Vlad不想在电话里说话，所以我们给他们发了一条消息，没想到他会回复。

直到... 
 
![](https://lh6.googleusercontent.com/iCjWb4HeUCo8uB3eZLfksQFxFJdMEruvDsRzzFmwqYZcDzlXOePo-OmTAsbF1HMT89YxccN-Xs1pGl39sI8B4V4HkKx5EDMqSMxLLqiahIAcE9urNAvJUfcMbqAYSGuzEEOpnt2U)
 
Vlad已经准备好说话。不幸的是，他没有太配合。  

![](https://lh6.googleusercontent.com/HE93DRIaDmYVHG4436QTGIPxZKsXJ0Ly4UXIojAKIPrpapwfQUyEJofxc4X2hZqyTwRkVnRALWfghAwR_BzCD6r0rPK1JQ-nQ5N2zpKhaLJuKVe8WYRj81PdojtL9oV9X9g4a75t)

![](https://lh5.googleusercontent.com/KnQgeeZ8ui5i0loOefPMXBmxwqOOWX0cJB9TZCWAmE9Mt1COguIZB9C8v6D3niEhzCNJuCbj68G0L5eslhSSa83M3XKpLAxSRJ-PUftnrtbN1sLy3fUCmM6JfCUYiySLc9d5wejK)

仍然可以通过@keccak在电报上联系到Vlad/keccak，然而他不再回复，并且已删除他账户上的图像。我们在此附上他的旧头像，供您考虑和调查。

我们已经得知--那张有狼的照片来自乌克兰著名的俄语漫画，上面写着"有事就来这里一趟"。

左边那张是反核武器的海报。

可惜对受影响的用户帮助不大。 

![](https://lh6.googleusercontent.com/-C_fEe5K7VtTZBgWbN1x0T08gdPgA644Vf_UlKT7ZpIwM8Yvg0-VF_NbIlm3B6aPfgFVcicuLn60v12XKHvN0IMPukME0JQS1wO15OBo0mG00qKujj9N8rM3dFCpkOZ5HTZVvR2q)

**一旦明确Vlad不愿意说出真相，我们便访问了Compounder的官方电报群，在那里，很明显我们的声誉先于我们。** 

![](https://lh6.googleusercontent.com/Bgibey9mMbZwxbZvLI3RpEsUKgqENRRGjySROwVuypAQaVeNqCnW4ZjPLOyXkLuzFDdAFs0UOXCVjeRdgZhrC3Fwaemg-0Jjfb0QSDBzvcDI_xggCXfFiRg52tqg3GwHIRQ9Qz6d)

当我们滚动浏览聊天内容时，我们看到了所有典型的行为，这些行为是由一个刚成立的跑路项目引起的。 

![](https://lh6.googleusercontent.com/3NDRvDXQyKMx7QH_4iiJs6BwoganIn8R0YE0fqk1z0MH8cRljLJwu8hUBaj_HYldnAuLBU1cP9yw6mEOuWfesjjBnhzs4UVDbZ3QjI9EWV7RdifLXikt3fy5jsB2IOoNy2dZNd9D)

即使是大玩家，也会被跑路项目的力量所折服。这个[群主](https://twitter.com/defiyield_info)损失了100万美元，并已开设自己的调查[小组](https://t.me/compounderopsec)（686名成员），以此进行复仇。 

![](https://lh4.googleusercontent.com/NymcDlq36Hf0ZJWBbN4BDjIlBI4rHhOTYmDMYGgvSNYjFLYG_Y6VWgubCqj9FTl7_AjBfx3uji0gstUdJkec4jTgzNPZT6lqT88cEj11ZchK9X8yPaNP7YTNmmif0D2ps8pkyR8T)

这个帖子可在[此处](https://twitter.com/defiyield_info/status/1333731633393004545?s=20)找到。

**统计数据**

作为调查的一部分，我们将Solidity.financial推荐给Stake Capital的[@vasa_develop](https://twitter.com/vasa_develop)，并请他们一起对事件进行全面的事后调查。

以下数据摘自他们的[报告](http://simpleaswater.com/cp3r)。

**被盗资产 (8)：**
•	8,077.540667包装过的ETH（4,820,030.07美元）
•	1,300,610.936154161964594323 yearn：yCRV金库（1,521,714.80美元）
•	0.016390153857154838 Compound（COMP）（1.79美元）
•	105,102,172.66293264 Compound USDT （2,169,782.85美元）
•	97,944,481.39815207 Compound美元币（2,096,403.68元）
•	1,934.23347357 Compound包装过的BTC（744,396.89美元）
•	23.368131489683158482 Aave Interest bearing YFI（628,650.174379401）
•	6,230,432.06773805 Compound Uniswap （466,378.99美元）

**遭到跑路（rug pull）项目攻击后有剩余资金的钱包**

•	[https://etherscan.io/address/0x944f214a343025593d8d9fd2b2a6d43886fb2474](https://etherscan.io/address/0x944f214a343025593d8d9fd2b2a6d43886fb2474)
•	1,800,000 DAI
•	[https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758](https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758)
•	5,066,124.665456504419940414 DAI
•	39.05381415 WBTC
•	4.38347845834390477 CP3R
•	0.004842656997849285 COMP.
•	0.000007146621650034 UNI-V2
•	从部署者第一次通过[Tornado.cash融资](https://etherscan.io/tx/0x2fc406e07328e04022b555b5cab69bc932d29d1115eca3d121cbd49da90fb817)到跑路（rug pull）项目，部署者向7个不同的地址发送了ETH。其中大部分是一次性付款。然而，其中[一个地址](https://etherscan.io/address/0x8f332c9ffb2be270d5c1c0de3fdac3d993517593)在11月19日、20日、22日和23日分别收到了4笔付款。该地址的大部分资金最终流向了另一个持有100多万KORE的[地址](https://etherscan.io/address/0xd6c35c1828a7062e21468768c546a64dd1be1602)（在他们跑路（rug pull）之前只存在1万KORE）。

这次黑客攻击的主要罪魁祸首是审计后在代码库中添加的7份恶意策略合约。

一份策略合约中的非恶意withdraw()函数看起来像这样。 

![](https://lh5.googleusercontent.com/t_BQNl6cnQmq98OvUsKf63yo8N93mJWbEOimWOmpkk8RyQHiOCXnBd7Q5iNRRzXZuemKX9vQ66bysjBdZFxaSClpp_jPERv2b6rH7XDgewnUUI6GWJrMEORb7S1339TOjV7nc8uL)

请注意，我们进行了一些检查项目，比如： 

![](https://lh5.googleusercontent.com/ZKGym0FbW_OC44MliLLqmvMJjbr2RanORW_G8pcdXTnWby52DXxayqpkIXFeJOEtpxbRZdncWo7yzSXyyAIsRmtF1kDXh1MAPS6-LmHqyOgt3Cuh_3s0dA1nJAbzEzmmQpYip2LV)

7份恶意战略合同中都缺少这些检查项目。这使得Controller合约（由-[跑路项目](https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758)策略师控制）可以从策略合约中提取资产。

（注意恶意提现功能中缺失以下检查项目） 完整的跑路（rug pull）攻击可以用4个步骤进行解释。

![](https://lh4.googleusercontent.com/LX2pt7hp6dieDg5bU-6hMQkIFeAh9ZCABSIADVQZ62Y6OXcF6lRk6eAWuYog5Hlz2GP2_o5tNmDhbKHF0bEYr1vjHRoOPCXn03Gdq-uyiSgushapH-slIkt87Dl7BSQC5QRHw0ou)

第一步

[Compounder.Finance：部署者](https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758)部署了7个恶意策略，同时操纵了withdraw()函数。

第二步

[Compounder.Finance：部署者](https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758)在StrategyController中通过Timelock（24小时）交易设置并批准7个恶意策略。

第三步

[Compounder.Finance：部署者](https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758) （策略师）在StrategyController上调用inCaseStrategyTokenGetStuck()，它滥用恶意策略中被操纵的 withdraw()函数，将策略中的代币转移到StrategyController上。对所有7个恶意策略执行相同步骤。

第四步

[Compounder.Finance：部署者](https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758)（策略师）在StrategyController上调用inCaseTokensGetStuck()，将StrategyController上的tokens转移到[Compounder.Finance：部署者](https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758)（策略师）地址：现在 [Compounder.Finance：部署者](https://etherscan.io/address/0x079667f4f7a0b440ad35ebd780efd216751f0758)（策略师）完全控制住价值12 464 316.329美元的8项资产。

从此，这些资产已转移到多个地址[此处](https://www.notion.so/Compounder-Finance-Post-Mortem-Report-9bf6b17dc1304606bb975968039a6dc8)。

**来自**[@vasa_develop](https://twitter.com/vasa_develop)**的优秀工作。

**如果你是举报人、网络侦探或Etherscan侦探，而你要进行举报，请联系我们。**
________________________________________

![](https://lh3.googleusercontent.com/4Ov6KyZOXXKLhn3ia1GsHXTlqJrJufMyscsMjjs8Ndd7OF6aVv6ULbfwodnZRZN_00m-iF4Bd3IZgCy4_z29XT8544n1sPjSd3COIRottpQgTgZ-1eF9jcJ75U6bBoveI6cSlg5g)

**最后审判日：**

谁是罪魁祸首？

经过我们的分析，**我们知道这不是审计人员的过错**，他们尽职尽责地完成了[他们的](https://solidity.finance/audits/CP3R/)任务，确保了Compounder Finance不受外部攻击，同时也在他们的[审计报告](https://solidity.finance/audits/CP3R/)和电报聊天室(https://solidity.finance/audits/CP3R/ChatLogs.pdf)中表达了他们的担忧。

也许他们可以稍稍大声地表达这些担忧，但终究，最终责任永远在存款人身上。

Compounder.financial用了一个时间锁作为指标，表示他们不会跑路。我们现在知道，这种方法不值得信任。如果使用它，应该建立一个自动警报系统或仪表板对该地址的交易进行监控。

24小时似乎不足以为用户提供足够警告让他们撤资。

**并非所有匿名创始人的项目都是骗局。这整个行业均由匿名者创立。**

然而，几乎所有的骗局都是匿名创始人的项目。作为一个社区，我们需要警惕这些项目；尤其是那些使用Tornado.cash无法追踪的资金来源的项目。

**仅仅有审计报告并不足以保证项目的安全性或合法性。**审计往往更多关注外部攻击者的风险，而不是内部的风险--也许这是审计人员需要加以改进的地方。

即使有审计、时间锁和销毁的私钥，存款人也总是受其他用户的摆布，他们可能随时向市场上抛售大量的代币。 

![](https://lh5.googleusercontent.com/m44dt8mlCqX_pt-Pm7xDUEJJFvZ78tpUndfyCPqpOfsz40B0i8siXxY_TnFHZIati3P8IPlKtrsn4urG_lCY66X5hRagresLo5uRqwIbuDpkHW4-2C0ar1TOG7lqrpLvBCFK6MlF)

**Solidity.Finance：官方声明**

Compounder团队换掉了安全/经审计的战略合同，替换成恶意"邪恶战略"合同，使他们得以窃取用户的资金。他们是通过一个公开但基本不受监控的24小时时间锁窃取资金。

_在我们的审计报告和与他们团队展开的讨论中提出了C3PR团队集中控制这一问题。该团队有权更新策略池，而他们在这里恶意的盗取用户资金。为了保持透明度，任何人都可以在[此处](https://solidity.finance/audits/CP3R/ChatLogs.pdf)查看我们与C3PR团队的聊天记录：_

从历史上看，我们的审计重点是外部攻击者给项目带来的风险，并就项目小组带来的风险进行一些讨论，正如我们在这里做的那样。我们将把这次不幸事件作为学习机会，今后将以简单易懂的语言提供更多关于开发人员控制风险的详细信息。 

![](https://lh4.googleusercontent.com/9YXkVrtF4HWEpH_Wyf9N7T6ttzQGR7m-Dfg5At40sFJV4Rz0FbF_7FLEn_E5SM2D6HSeG7iymcg7T9DSLJkBP8SSCL0EuTWdiia6nnGhXD1vy-4ChPhbQh_seYfFHXRb94Wh1ILc)

我们都知道在投资前应该通读智能合约，但知识壁垒很高。并非每个人都知道该注意什么，而那些知道的人也没有动力去分享他们的发现。

在C3PR案例中，愿意倾听的用户很早便意识到危险，而使跑路成为可能的代码始终存在。

尽管如此，合约中累计超过12000万美元，现在可以被冠上"史上最大的跑路事件之一"。

![](https://lh5.googleusercontent.com/5GlWMNDDXxJnsVsr0MxTgGKLmHwwlEjF7ufbN7LefUMdNaGsPDSCExLRHjavO4Vg4lQkR_wzRNF4jFxOqH6v4BsMmFUS7UXF_wMyR8S1xdjGVloDBVwR-bS6EZ1bBnPDFtXDvdMt)


