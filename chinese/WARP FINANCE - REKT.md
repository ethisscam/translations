---
title: WARP FINANCE - REKT
date: 2020年12月18日
tags:
  - warp finance
  - Rekt
excerpt: 我们遇到的所有人，都是由善与恶混合而成的：两张面孔和两种人格，有着共同的隐秘目标。如同杰基尔之于海德，白帽之于黑帽。具有不可抗拒效果的知识源泉-当没有惩罚时，我们谁能抗拒这样的奖励？
banner: https://lh6.googleusercontent.com/cu47l8eTpNnHgVR_A2gq2boptXZBIIFHI0yO9ptnxWEDwjkAjVTH4vKPdrbsAe2nQZQNtz2YLiEfEb-UpPVg2-Mqk1kh3U-mxquiJZTn8TD1DsjtBVAdSPDvu0rB08TjRGmdycBP
---

![](https://lh6.googleusercontent.com/cu47l8eTpNnHgVR_A2gq2boptXZBIIFHI0yO9ptnxWEDwjkAjVTH4vKPdrbsAe2nQZQNtz2YLiEfEb-UpPVg2-Mqk1kh3U-mxquiJZTn8TD1DsjtBVAdSPDvu0rB08TjRGmdycBP)

**你在街上遇到的每一个人都不是一个人，而是两个人...**

我们遇到的所有人，都是由善与恶混合而成的：两张面孔和两种人格，有着共同的隐秘目标。

**如同杰基尔之于海德，白帽之于黑帽。**白天我们所信任的开发人员，在夜晚可能会有不同的人格。

具有不可抗拒效果的知识源泉-当没有惩罚时，我们谁能抗拒这样的奖励？

由于具备这些特殊能力的[开发人员](https://twitter.com/warpfinance/status/1339751978977685507?s=20)少之又少，我们面临的可能是好像给了你一点,另一只手又把它拿回来。。 

![](https://lh4.googleusercontent.com/yCI9vRUEqPRtw70zfTEfCnYowW-jMvvCppKOPyd5zUqbEHbw1JSxd6Y4y8QcMZyTBkx0xJ4RSNz0Wm-Z7FQH2q91pQtT3D22yYXLt8CEVsXs5DCan0KRcxFViCGBwTBDHsH-QTCm)

**Warp Finance是越来越不起眼的黑客大流行中的最新受害者。 **

一个通过 Tornado cash只用一个ETH注资的[账户](https://ethtx.info/mainnet/0x8bb8dc5c7c830bac85fa48acad2505e9300a91c3ff239c9517d0cae33b595090)，签定了一份合约，从Uniswap闪电换取了1.8亿美元，从dYdX闪电贷了5100万美元。

利用这种技术，攻击者能够移除780万美元的DAI，这得益于Warp.finance依赖脆弱的Uniswap LP代币价格。这使他们能够借到比抵押品更多的资金，并导致稳定币出借人资金流失。

涉及的钱包名单如下

**Attacker SC **[0xdf8bee861227ffc5eea819c332a1c170ae3dbacb](https://etherscan.io/address/0xdf8bee861227ffc5eea819c332a1c170ae3dbacb)

Warp Oracle [0x4A224CD0517f08B26608a2f73bF390b01a6618c8](https://etherscan.io/address/0x4A224CD0517f08B26608a2f73bF390b01a6618c8)

Warp Control [0xBa539B9a5C2d412Cb10e5770435f362094f9541c](https://etherscan.io/address/0xBa539B9a5C2d412Cb10e5770435f362094f9541c)

wBTC-wETH LP 金库 [0x3c37f97F7d8f705cc230f97a0668f77a0e05D0aA](https://etherscan.io/address/0x3c37f97F7d8f705cc230f97a0668f77a0e05D0aA)

WETH-DAI LP 金库 **[0x13db1CB418573f4c3A2ea36486F0E421bC0D2427](https://etherscan.io/address/0x13db1CB418573f4c3A2ea36486F0E421bC0D2427) **（受影响金库）

USDT-WETH LP 金库 [0xCDb97F4C32F065b8e93cF16BB1E5d198bcF8cA0d](https://etherscan.io/address/0xCDb97F4C32F065b8e93cF16BB1E5d198bcF8cA0d)

USDC-WETH LP 金库 [0xb64dfae5122D70Fa932f563c53921FE33967B3E0](https://etherscan.io/address/0xb64dfae5122D70Fa932f563c53921FE33967B3E0)

DAI 金库 [0x6046c3Ab74e6cE761d218B9117d5c63200f4b406](https://etherscan.io/address/0x6046c3Ab74e6cE761d218B9117d5c63200f4b406)

USDT 金库 [0xDadd9bA311192d360Df13395E137f1E673C91deB](https://etherscan.io/address/0xDadd9bA311192d360Df13395E137f1E673C91deB)

USDC 金库 [0xae465FD39B519602eE28F062037F7B9c41FDc8cF](https://etherscan.io/address/0xae465FD39B519602eE28F062037F7B9c41FDc8cF)

**rekt OPSEC向我们提供了以下概要**

•	WarpFinance被利用，从其金库（WarpVaultSC）中抽走了约780万美元的DAI/USDC。

•	攻击是在2020年12月17日晚上10:24:41+UTC（[交易](https://ethtx.info/mainnet/0x8bb8dc5c7c830bac85fa48acad2505e9300a91c3ff239c9517d0cae33b595090)）发起的，

•	此次事件的根本原因是使用了基于AMM的预言机（Uniswap），这使得攻击者得以操纵UniswapV2对（WETH-DAI）LP代币的价格。

•	这种闪电贷诱导的Uniswap价格操纵导致攻击者从WarpFinance借贷平台上借入比应该借入的更多（大约两倍）的USDC和DAI。

•	值得注意的一点是，攻击者不会立即从中获利。

•	攻击者存入的LP代币作为抵押品持有，并由于水下借款仓位而被锁定在Warpfinance中。

**交易演练：**

•	从dYdX和UniswapV2的290万DAI+344.8K WETH中抽取四笔不同的闪电贷；WETH-WBTC 9万 WETH-USDC 8.2万 WETH-USDT 9.6万 WETH dYdX 7.6万 WETH dYdX 290万DAI。

•	将dYdX闪电贷（290万DAI+7.6万 WETH）存入UniswapV2对（WETH-DAI），并相应铸造9.4349万LP代币。

![](https://lh6.googleusercontent.com/D0Q0LzrWP7qJncRlvHLcnvIa-K8Kb1EY4Y92q92DYz9AIGLah2JcK4z6Qi04otZ4jxFxoPonvXi_WEIaa0jb8L6rUa4iojgNmgYZJd78KkM0b_K2WAPiR0WdnwJls47UjFZeRbGF)
 
•	然后将铸造好的代币转入WarpVault LP，作为攻击者信用的抵押品；（目前UniswapV2对WETH-DAI LP代币的价格为58,815,427美元）

•	通过UniswapV2将34.1万WETH兑换成4760万DAI，进而抬高DAI 的价格，这样一来，LP代币价格至少翻了一倍，达到135,470,392。

•	凭借更高的LP代币价格和更高的计算抵押品价值，攻击者能够从WarpFinance借到386万DAI和390万USDC（价值约780万美元）

![](https://lh3.googleusercontent.com/FjOa_KgUH2BZFUxv8Azyh_S78EXf7xp-olHSuxbJh01qwZsMnF3LUF0wV9KarNpD_MHnYRYHKZXJiTb5NphmKhjh94eJyG-iUDjjNUZYSBS1V80108K35p0U9qKaO8rL8e8cnrAz)
 
•	将步骤1中的闪电贷返还给dYdX和UniswapV2。

•	攻击者损失了大部分交易费用的收益。

•	虽然此次事件导致约780万美元的损失，但攻击者并没有立即从中获益。具体来说，攻击者目前在WarpFinance的水下借款仓位，仍锁定了9434.9万枚LP代币。同时，我们正在积极监控攻击者钱包是否有任何动作。

![](https://lh3.googleusercontent.com/TL9LpgYGa--08j2t5KRVvWfLi_PtVpV68f_qFni86PIM4WHuKEhl33Tz56_XiwevCYzfHcd2s7Ih0xdYoXSut2_m6_nGY1KnELgiONcDVQ5Kd_3z-Cnn8w3pg7odfJgKkfuNFMEN)

饼状图感谢--[@n2ckchong](https://twitter.com/n2ckchong/status/1339727569436901378?s=20) 

![](https://lh4.googleusercontent.com/OvaHZqCaAJMaoW7BBHoXtkmw8zPc4ZuYeeMcGpk5OeFJoZc5IDqi7HWIsclDhvs_281kepFEmKQjsbt2ZVkB7O6LwVtRfqrKNNswRznJAZmj9YOkRGNmVFwgn17UlOtUwVZ_mIZQ)
 
> 千好万好总有终，最宽广的尺度终于被填满，这短暂的对邪恶的屈服，终于摧毁了我灵魂的平衡。

**攻击者还要多久才会满足？**

仅仅是其中的一次抢劫，就能提供足够的金钱，让抢劫者再也不需要工作了，所以后续影响则说明了这些行动者追求的是权力，而不是财富。或者说金钱对于技术型的人来说并不感兴趣，他们像猫捉老鼠一样玩弄受害者。

**当这些攻击引起如此少的关注时，这表明了这个行业还不成熟。**在加密货币之外，700万美元的抢劫案将成为国际头条新闻，然而对于去中心化金融公司来说，这个最新的漏洞显得有些乏味，是已知攻击因子的基本重复。

由于大部分资金都被持有，并且可以通过清算从金库换一个新的控制人来收回，攻击者已经创造了一笔可观的赏金。

也许在未来，一个利他主义的攻击者会使用这种方法为用户提供一个赎回资金的机会，而不是随便拿走资金。**攻击者可以以赎金的方式持有资金，要求返还款项；迫使协议支付否则进一步毁坏其声誉。**

杰基尔（Jekyll）博士并没有炼制丹药，去掉他身上的邪气。他炼制了丹药，使他能够表达他的冲动，而不会感到内疚，也不会对他的声誉造成任何后果。

**去中心化金融是一个充满假名和阴谋的世界，在这里，匿名赋予了权力，白帽黑客变成了灰帽黑客。**

当warp.financial使用推特感谢他们的白帽开发人员时，他们提到的[名字](https://twitter.com/warpfinance/status/1339751978977685507?s=20)有一种显而易见的熟悉感。

**我们都和这些熟悉的面孔一起进餐，但当我们背对着他们时，他们会喝我们的奶昔吗？**

![](https://lh6.googleusercontent.com/G8QlXjqEUXZq0bbcMpE2TDey6BmRdSY49EEHs1z1vEjA-Lg0_aAl-CVI-KGXXIsHAf3RjyLfKyFWyb69Bf-E_HOx2a_Jz_V5EuSDN0YEQ5euqOEdNANHHDb_Q5Mq6la5bGn_xI76)
